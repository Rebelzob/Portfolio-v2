---

const navItems = [
  {
    name: 'About',
    link: 'about',
    url: '/#about'
  },
  {
    name: 'Projects',
    link: 'projects',
    url: '/#projects'
  },
  {
    name: 'Contact',
    link: 'contact',
    url: '/#contact'
  }
]
---

<header class='flex justify-between items-center py-3 sticky top-0 w-full z-10 my-2 px-5 mx-auto pt-2'>
  <img src="/photo.png" alt="karim" class="rounded-full w-12 h-12">
  <nav class="flex flex-row gap-3 opacity-80">
    {
      navItems.map((item) => 
        <a
          class="hover:bg-white/10 p-1 rounded-full px-2 sm:px-3 transition ease-in text-sm sm:text-base capitalize"
          aria-label="{item.label}"
          href="{item.url}"
        >
          {item.name}
        </a>
      )
    }
  </nav>
</header>

<script>
  document.addEventListener("astro:page-load", () => {
    const sections = document.querySelectorAll('section')
    const nav = document.querySelectorAll('header nav a')

    const callback = (entries: any[]) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          nav.forEach((link) => {
            if (link.getAttribute('arial-label') == entry.target.id) {
              link.classList.add('link-active')
            } else {
              link.classList.remove('link-active')
            }
          })
        }
      })
    }

    const observer = new IntersectionObserver(callback, {
      root: null,
      rootMargin: '-50% 0px -50% 0px',
      threshold: 0.3
    })

    sections.forEach((section) => {
      observer.observe(section)
    })
  })
</script>

<style>
  nav {
    animation: nav-shadow 1s linear both;
    animation-timeline: scroll();
    animation-range: 0 400px;
  }

  @keyframes nav-shadow {
    to {
      @apply shadow-xl;
    }
  }
</style>
